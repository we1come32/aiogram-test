# Тестовое задание по технологии Aiogram 

## Настройка работы

### Переменные окружения

Необходимо локально создать файл .env, в котором необходимо указать необходимые параметры:

| Название           | Статус   | Стандартное значение | Описание                                                                    |
|--------------------|----------|----------------------|-----------------------------------------------------------------------------|
| TELEGRAM_BOT_TOKEN | Required | _Отсутствует_        | Ключ доступа к боту                                                         |
| CACHE_STORAGE      | Optional | _Отсутствует_        | Строка подключения к Redis-серверу, по умолчанию используется MemoryStorage |
| DATABASE           | Optional | `sqlite:///cache.db` | Строка подключения к базе данных                                            |
| WEATHER_API_TOKEN  | Required | _Отсутствует_        | Ключ доступа к API https://www.weatherapi.com                               |

### Установка

1) Клонирование репозитория `git clone https://github.com/we1come32/aiogram-test.git`
2) Настройка [переменных окружения](README.md:5)
3) Создание виртуального окружения `python3 -m venv .venv` (для Linux)
4) Активация виртуального окружения `source .venv/bin/activate` (для Linux)
5) Установка зависимостей `pip install -r requirements.txt`

### Запуск

Запуск производится двумя способами (необходимо активированное виртуальное окружение):
1. Как приложение `python main.py`
2. Как веб-приложение с вебхуками: `python web_main.py`

## Описание задания
Общее описание: Тестовое задание состоит из 10 задач, направленных на оценку знаний и навыков работы с библиотекой Aiogram. Задачи расположены в порядке увеличения сложности.

Стек: 
- Python
- GitHub
- Linux
- PostgreSQL
- Redis
- Celery
- Aiogram
- Django

Задачи:
1. Создание бота и обработка команд

Создать Telegram-бота, который отвечает на команду /start сообщением "Добро пожаловать в наш бот!", и команду /help сообщением "Доступные команды: /start, /help, /echo, /photo".

Критерии проверки:
- Корректное создание бота и настройка диспетчера
- Обработка команд /start и /help

2. Команда /echo

Добавить команду /echo, которая будет возвращать пользователю его собственное сообщение.

Критерии проверки:
- Корректная обработка команды /echo
- Правильный возврат сообщения пользователя

3. Inline кнопки и обработка коллбеков

Создать inline-кнопки с опциями "Выбор 1" и "Выбор 2”. При нажатии на любую из них бот должен отвечать соответствующим сообщением "Вы выбрали Выбор 1" или "Вы выбрали Выбор 2".

Критерии проверки:
- Корректная работа inline-кнопок
- Правильная обработка коллбеков и ответ на нажатие

4. Хранение данных пользователя с использованием FSM (Finite State Machine)

Реализовать бота, который запрашивает у пользователя его имя и возраст, сохраняя эти данные с использованием FSM и выводит их в конце.

Критерии проверки:
- Корректная реализация FSM
- Правильное сохранение и отображение введенных данных

5. Загрузка и обработка изображений

Добавить возможность пользователю отправлять изображение, на которое бот будет отвечать размером изображения в пикселях (ширина x высота).

Критерии проверки:
- Корректная загрузка изображений
- Правильное определение и вывод размеров изображения

6. Интеграция с базой данных SQLite

Создать таблицу пользователей в базе данных SQLite и сохранить в неё данные пользователя (ID, имя, возраст). Реализовать команду /users для вывода всех пользователей.

Критерии проверки:
- Корректная работа с SQLite
- Правильное сохранение и извлечение данных
- Корректный вывод списка пользователей

7. Обработка данных с API

Реализовать команду /weather, которая будет запрашивать у пользователя название города и выводить текущую погоду, используя API (например, OpenWeatherMap).

Критерии проверки:
- Корректная работа с API
- Правильная обработка и вывод данных о погоде

8. Работа с вебхуками

Настроить вебхуки для вашего бота на локальном сервере с использованием ngrok. Реализовать обработку команд через вебхуки.

Критерии проверки:
- Корректная настройка вебхуков
- Правильная обработка команд через вебхуки

9. Периодические задачи (Scheduled Tasks)

Добавить функционал, который будет отправлять пользователям сообщение "Не забудьте проверить уведомления!" каждый день в 9:00 утра.

Критерии проверки:
- Корректная реализация периодических задач
- Отправка сообщения в заданное время

10. Обработка ошибок и исключений

Реализовать обработку исключений, чтобы бот отправлял сообщение "Произошла ошибка, попробуйте позже" в случае любой ошибки.

Критерии проверки:
- Корректная обработка исключений
- Правильное уведомление пользователя об ошибке
